{% extends 'movie/base.html' %} {% block content %}

<link
  href="{% static 'css/star-rating.css' %}"
  media="all"
  rel="stylesheet"
  type="text/css"
/>
<script src="{% static 'js/star-rating.js' %}" type="text/javascript"></script>
<style>
  .poster {
    float: left;
    margin: 3px 12px 0 0;
    overflow: hidden;
    text-align: center;
  }

  .info {
    max-width: 800px;
    margin-top: 15px;
    float: left;
    word-wrap: break-word;
  }
  .smovie {
    width: 300px;
    display: block;
    font-size: 15px;
    text-align: center;
    margin: 0 25px 10px 0;
    overflow: hidden;
  }
  hr {
    -moz-border-bottom-colors: none;
    -moz-border-image: none;
    -moz-border-left-colors: none;
    -moz-border-right-colors: none;
    -moz-border-top-colors: none;
    border-color: #2994dc;
    border-style: solid none;
    border-width: 1px 0;
    margin: 18px 0;
  }
  .star-rating {
    font-size: 2rem;
  }

  .genre-tag {
    border: 1px solid #a19d9d;
    border-radius: 8px;
    margin: 9px 18px 9px 0;
    padding: 4px 10px;
  }
</style>
<div class="flex">
  {% if login %}
  <div class="border-r border-r-white pr-4 mr-4">
    <h3 class="text-white text-lg font-bold">YOUR RATINGTING</h3>
    {# 利用js动态生成，依赖这个form#}
    <form class="star" action="" method="post">
      {# 评分组件#}
      <input
        id="input-2ba"
        name="score"
        value="{{ score }}"
        type="number"
        class="rating"
        min="0"
        max="5"
        step="0.5"
        data-stars="5"
        data-symbol="&#xe005;"
        data-default-caption="{rating} hearts"
        data-star-captions="{}"
      />
      <label for="comment" class="text-white text-lg font-bold">Comment</label>
      <textarea
        class="form-control bg-[#777777] border-none"
        name="comment"
        rows="5"
        id="comment"
      >
    {{ comment }}</textarea
      >
      <br />
      <div class="form-group">
        {# 提交的按钮#}
        <button
          type="submit"
          class="btn bg-[#48C4EB] rounded-[16px] text-white hover:text-white shadow-lg"
          style="margin-right: 10px"
        >
          Submit
        </button>
        <button type="reset" class="btn btn-default rounded-[16px]">
          Clear
        </button>
      </div>
    </form>
    <br />
    <script>
      jQuery(document).ready(function () {
        $(".rating-kv").rating();
      });
    </script>
  </div>

  {% endif %}
  <div>
    <!--展示电影信息-->
    <div class="flex flex-col">
      <div class="poster">
        <a href="{% url 'movie:detail' movie.pk %}" class="item">
          <div class="poster_div">
            <img src="/static/movie/poster/{{ movie.imdb_id }}.jpg" alt="" />
          </div>
        </a>
      </div>
      <div class="info">
        <p class="text-[36px] text-white">{{ movie.name }}</p>

        <p>
          {% for genre in movie.get_genre %}
          <a href="{% url 'movie:tag' %}?genre={{ genre }}" class="genre-tag"
            >{{ genre }}</a
          >
          {% if not forloop.last %} {% endif %} {% endfor %}
        </p>
        <p class="mt-4">
          <span>
            {% for foo in movie.get_score_int_range %} ❤ {% endfor %}
          </span>
          <strong style="color: #e09015">{{ movie.get_score }}</strong>
        </p>
        <h3 class="text-white mt-4">Movie Information</h3>
        <p class="text-white text-[24px] my-6">Synopsis</p>
        <p>{{ movie.intro }}</p>
        <p class="text-white text-[24px] my-6">Director</p>
        <p>{{ movie.director }}</p>
        <p class="text-white text-[24px] my-6">Writers</p>
        <p>{{ movie.writers }}</p>
        <p class="text-white text-[24px] my-6">Casts</p>
        <p>{{ movie.actors }}</p>

        <p>Running Time：{{ movie.time }}</p>
        <p>Release Date：{{ movie.release_time }}</p>
      </div>
    </div>

    <!-- 播放按钮 -->
    <div class="container">
      <br />
      <a href="{{ play_link }}" class="btn btn-primary">See the trailer</a>
    </div>

    <div class="container">
      <br />
      {% for message in messages %} {% if message.tags == 'info' %}
      <div class="alert alert-info" role="alert">{{ message }}</div>
      {% endif %} {% endfor %}
    </div>
  </div>

  <div class="similarity_movie flex flex-col gap-4">
    <h3>Similar</h3>
    {% for movie in similarity_movies %}
    <div class="smovie">
      <a
        href="{% url 'movie:detail' movie.pk %}"
        class="poster !float-none !w-auto"
      >
        <div class="poster_div shadow-lg flex gap-4">
          <img
            src="/static/movie/poster/{{ movie.imdb_id }}.jpg"
            style="width: 122px; object-fit: cover; flex-shrink: 0"
            alt=""
          />
          <div
            class="flex flex-col flex-grow justify-center items-center gap-4"
          >
            <p
              class="whitespace-nowrap w-full text-left text-ellipsis overflow-hidden mt-5 hover:text-white text-sm"
              title="{{movie.name}}"
            >
              <span>{{ movie.name }}</span>
            </p>
            <div
              class="rating inline-flex items-center justify-cener !relative"
            >
              <strong>{{ movie.get_score }}</strong>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="12"
                height="12"
                viewBox="0 0 24 24"
                fill="currentColor"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="lucide lucide-star ml-1"
              >
                <polygon
                  points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"
                />
              </svg>
            </div>
          </div>
        </div>
      </a>
    </div>

    {% endfor %}
  </div>
</div>
{% endblock %}
