<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="shortcut icon" href="{% static 'movie/favicon1.ico' %}" />
    <link rel="bookmark" href="{% static 'movie/favicon1.ico' %}" />
    <meta charset="UTF-8" />
    <title>Film</title>
    <!--引入jQuery-->
    <link
      rel="stylesheet"
      href="{% static 'bootstrap/css/bootstrap.min.css' %}"
    />
    <script src="/static/bootstrap/js/jquery.min.js"></script>
    <script src="/static/bootstrap/js/bootstrap.min.js"></script>
    <script src="/static/js/tailwind.js"></script>
    <script src="{% static 'layer/layer.js' %}"></script>
    <style>
      html,
      body {
        font-size: 16px;
        color: #a19d9d;
      }

      :root {
        --primary-color: #48c4eb;
      }

      body {
        --tw-bg-opacity: 1;
        --tw-text-opacity: 1;
        background: rgb(28 28 30 / var(--tw-bg-opacity));
      }
      .border-gray-darken {
        --tw-border-opacity: 1;
        border-color: rgb(58 57 57 / var(--tw-border-opacity));
      }
      .bg-dark-lighten {
        --tw-bg-opacity: 1;
        background-color: rgb(51 51 53 / var(--tw-bg-opacity));
      }
      .logo {
        width: 71px;
        height: 46px;
      }
      .nav-item.active {
        border-right: 8px solid #48c4ebb8;
        color: #48c4ebb8;
      }

      .poster {
        display: block;
        float: left;
        text-align: center;
        width: 122px;
      }
      .poster:hover {
        color: white !important;
      }

      .poster .poster_div {
        overflow: hidden;
        position: relative;
      }
      .poster_div img {
        width: 122px;
        height: 174px;
        border-radius: 10px;
        overflow: hidden;
      }
      .poster_div .rating {
        position: absolute;
        top: 4px;
        left: 4px;
        border-radius: 4px;
        font-size: 12px;
        background: #48c4ebb8;
        color: white;
        padding: 4px 10px;
      }

      .left-menu.menu-collapse {
        width: 60px;
        padding-left: 0;
      }
      .left-menu.menu-collapse .left-main-menu {
        display: none;
      }
      .left-menu.menu-collapse p {
        display: none;
      }
      .left-menu.menu-collapse div {
        margin-left: 0;
      }
      .left-menu.menu-collapse a {
        justify-content: center;
      }
      .pagination {
      }
      .pagination li a {
        color: #a19d9d !important;
        background: #313131 !important;
      }
      .pagination li.active a {
        color: white !important;
        border-color: white !important;
      }

      .custom-msg {
        top: 50px !important;
        left: auto !important;
        right: 50px;
        background: white;
      }
    </style>
  </head>
  <body class="bg-dark text-gray-lighten">
    <div class="flex h-screen items-start">
      <div
        class="left-menu shrink-0 md:max-w-[260px] w-[70vw] pl-8 top-0 pt-10 md:sticky md:translate-x-0 md:bg-transparent md:shadow-none -translate-x-full fixed min-h-screen shadow-md transition duration-300 bg-dark-lighten z-50 pb-12 border-r border-gray-darken"
      >
        <div class="flex items-center justify-center gap-4 px-2">
          <img src="/static/img/logo.jpeg" class="logo" alt="" />
          <p class="text-[24px] font-bold">
            <span class="text-white">DREAM</span
            ><span class="text-primary">ING</span>
          </p>
        </div>
        <div class="text-white text-lg font-medium mt-12 left-main-menu">
          MENU
        </div>
        <div class="mt-8 ml-4 flex flex-col gap-6">
          <a
            class="nav-item flex gap-6 items-center hover:text-white transition duration-300"
            href="{% url 'movie:index' %}"
            ><svg
              stroke="currentColor"
              fill="currentColor"
              stroke-width="0"
              viewBox="0 0 1024 1024"
              height="25"
              width="25"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M946.5 505L560.1 118.8l-25.9-25.9a31.5 31.5 0 0 0-44.4 0L77.5 505a63.9 63.9 0 0 0-18.8 46c.4 35.2 29.7 63.3 64.9 63.3h42.5V940h691.8V614.3h43.4c17.1 0 33.2-6.7 45.3-18.8a63.6 63.6 0 0 0 18.7-45.3c0-17-6.7-33.1-18.8-45.2zM568 868H456V664h112v204zm217.9-325.7V868H632V640c0-22.1-17.9-40-40-40H432c-22.1 0-40 17.9-40 40v228H238.1V542.3h-96l370-369.7 23.1 23.1L882 542.3h-96.1z"
              ></path>
            </svg>
            <p>Home</p></a
          >
          <a
            class="nav-item flex gap-6 items-center hover:text-white transition duration-300"
            href="{% url 'movie:tag' %}"
            ><svg
              stroke="currentColor"
              fill="currentColor"
              stroke-width="0"
              viewBox="0 0 24 24"
              height="25"
              width="25"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path fill="none" d="M0 0h24v24H0V0z"></path>
              <path
                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-5.5-2.5l7.51-3.49L17.5 6.5 9.99 9.99 6.5 17.5zm5.5-6.6c.61 0 1.1.49 1.1 1.1s-.49 1.1-1.1 1.1-1.1-.49-1.1-1.1.49-1.1 1.1-1.1z"
              ></path>
            </svg>
            <p>Explore</p></a
          >
          <a
            class="nav-item flex gap-6 items-center hover:text-white transition duration-300"
            href="{% url 'movie:search' %}?keyword="
          >
            <svg
              stroke="currentColor"
              fill="currentColor"
              stroke-width="0"
              viewBox="0 0 24 24"
              height="25"
              width="25"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M10 18a7.952 7.952 0 0 0 4.897-1.688l4.396 4.396 1.414-1.414-4.396-4.396A7.952 7.952 0 0 0 18 10c0-4.411-3.589-8-8-8s-8 3.589-8 8 3.589 8 8 8zm0-14c3.309 0 6 2.691 6 6s-2.691 6-6 6-6-2.691-6-6 2.691-6 6-6z"
              ></path>
            </svg>
            <p>Search</p>
          </a>
        </div>
        {% if movie_user %}
        <div class="text-white text-lg font-medium mt-12 left-main-menu">
          Recommendation
        </div>
        <div class="mt-8 ml-4 flex flex-col gap-6">
          <a
            class="nav-item flex gap-6 items-center hover:text-white transition duration-300"
            id="recommend-nav"
            href="{% url 'movie:recommend' %}"
            ><svg
              height="25"
              width="25"
              viewBox="0 0 38 38"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M30.0833 6.33335H23.465C22.8 4.49669 21.0583 3.16669 19 3.16669C16.9417 3.16669 15.2 4.49669 14.535 6.33335H7.91667C6.175 6.33335 4.75 7.75835 4.75 9.50002V31.6667C4.75 33.4084 6.175 34.8334 7.91667 34.8334H30.0833C31.825 34.8334 33.25 33.4084 33.25 31.6667V9.50002C33.25 7.75835 31.825 6.33335 30.0833 6.33335ZM19 5.93752C19.3483 5.93752 19.6492 6.09585 19.8708 6.33335C20.0608 6.53919 20.1875 6.82419 20.1875 7.12502C20.1875 7.77419 19.6492 8.31252 19 8.31252C18.3508 8.31252 17.8125 7.77419 17.8125 7.12502C17.8125 6.82419 17.9392 6.53919 18.1292 6.33335C18.3508 6.09585 18.6517 5.93752 19 5.93752ZM30.0833 31.6667H7.91667V9.50002H30.0833V31.6667ZM19 11.0834C16.3875 11.0834 14.25 13.2209 14.25 15.8334C14.25 18.4459 16.3875 20.5834 19 20.5834C21.6125 20.5834 23.75 18.4459 23.75 15.8334C23.75 13.2209 21.6125 11.0834 19 11.0834ZM19 17.4167C18.1292 17.4167 17.4167 16.7042 17.4167 15.8334C17.4167 14.9625 18.1292 14.25 19 14.25C19.8708 14.25 20.5833 14.9625 20.5833 15.8334C20.5833 16.7042 19.8708 17.4167 19 17.4167ZM9.5 27.6609V30.0834H28.5V27.6609C28.5 23.7025 22.2142 21.9925 19 21.9925C15.7858 21.9925 9.5 23.6867 9.5 27.6609ZM13.1575 26.9167C14.25 26.03 16.9258 25.1434 19 25.1434C21.0742 25.1434 23.7658 26.03 24.8425 26.9167H13.1575Z"
                fill="#A19D9D"
              />
            </svg>
            <p>For You</p></a
          >
          <a
            class="nav-item flex gap-6 items-center hover:text-white transition duration-300"
            href="{% url 'movie:portray' %}"
            ><svg
              stroke="currentColor"
              fill="currentColor"
              stroke-width="0"
              viewBox="0 0 24 24"
              height="25"
              width="25"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12 2A10.13 10.13 0 0 0 2 12a10 10 0 0 0 4 7.92V20h.1a9.7 9.7 0 0 0 11.8 0h.1v-.08A10 10 0 0 0 22 12 10.13 10.13 0 0 0 12 2zM8.07 18.93A3 3 0 0 1 11 16.57h2a3 3 0 0 1 2.93 2.36 7.75 7.75 0 0 1-7.86 0zm9.54-1.29A5 5 0 0 0 13 14.57h-2a5 5 0 0 0-4.61 3.07A8 8 0 0 1 4 12a8.1 8.1 0 0 1 8-8 8.1 8.1 0 0 1 8 8 8 8 0 0 1-2.39 5.64z"
              ></path>
              <path
                d="M12 6a3.91 3.91 0 0 0-4 4 3.91 3.91 0 0 0 4 4 3.91 3.91 0 0 0 4-4 3.91 3.91 0 0 0-4-4zm0 6a1.91 1.91 0 0 1-2-2 1.91 1.91 0 0 1 2-2 1.91 1.91 0 0 1 2 2 1.91 1.91 0 0 1-2 2z"
              ></path>
            </svg>
            <p>Profile</p></a
          >
        </div>

        <div class="text-white text-lg font-medium mt-12 left-main-menu">
          PERSONAL
        </div>
        <div class="mt-8 ml-4 flex flex-col gap-6">
          <a
            class="nav-item flex gap-6 items-center hover:text-white transition duration-300"
            href="{% url 'movie:history' movie_user.id %}"
            ><svg
              stroke="currentColor"
              fill="currentColor"
              stroke-width="0"
              viewBox="0 0 1024 1024"
              height="25"
              width="25"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 0 0 3 14.1zm167.7 301.1l-56.7-19.5a8 8 0 0 0-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 0 1-112.5 75.9 352.18 352.18 0 0 1-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 0 1-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 0 1 171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 0 1 112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 0 1 775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"
              ></path>
            </svg>
            <p>History</p></a
          >
        </div>
        {% endif %} {% if movie_user.name == "root"%}
        <div class="text-white text-lg font-medium mt-12 left-main-menu">
          MANAGEMENT
        </div>
        <div class="mt-8 ml-4 flex flex-col gap-6">
          <a
            class="nav-item flex gap-6 items-center hover:text-white transition duration-300"
            href="{% url 'movie:stat' %}"
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-layout-dashboard"
            >
              <rect width="7" height="9" x="3" y="3" rx="1" />
              <rect width="7" height="5" x="14" y="3" rx="1" />
              <rect width="7" height="9" x="14" y="12" rx="1" />
              <rect width="7" height="5" x="3" y="16" rx="1" />
            </svg>
            <p>Dashboard</p></a
          >
        </div>
        {% endif %} {% if movie_user %}
        <div class="text-white text-lg font-medium mt-12 left-main-menu">
          General
        </div>
        <div class="mt-8 ml-4 flex flex-col gap-6">
          <a
            class="nav-item flex gap-6 items-center hover:text-white transition duration-300"
            href="{% url 'movie:info' %}"
            ><svg
              width="24"
              height="24"
              viewBox="0 0 38 38"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M19 3.1665C10.26 3.1665 3.16663 10.2598 3.16663 18.9998C3.16663 27.7398 10.26 34.8332 19 34.8332C27.74 34.8332 34.8333 27.7398 34.8333 18.9998C34.8333 10.2598 27.74 3.1665 19 3.1665ZM11.6375 29.2915C13.7116 27.8032 16.245 26.9165 19 26.9165C21.755 26.9165 24.2883 27.8032 26.3625 29.2915C24.2883 30.7798 21.755 31.6665 19 31.6665C16.245 31.6665 13.7116 30.7798 11.6375 29.2915ZM28.7216 27.1065C26.0458 25.0165 22.6733 23.7498 19 23.7498C15.3266 23.7498 11.9541 25.0165 9.27829 27.1065C7.44163 24.9057 6.33329 22.0873 6.33329 18.9998C6.33329 12.0015 12.0016 6.33317 19 6.33317C25.9983 6.33317 31.6666 12.0015 31.6666 18.9998C31.6666 22.0873 30.5583 24.9057 28.7216 27.1065Z"
                fill="#A19D9D"
              />
              <path
                d="M19 9.49984C15.9441 9.49984 13.4583 11.9857 13.4583 15.0415C13.4583 18.0973 15.9441 20.5832 19 20.5832C22.0558 20.5832 24.5416 18.0973 24.5416 15.0415C24.5416 11.9857 22.0558 9.49984 19 9.49984ZM19 17.4165C17.6858 17.4165 16.625 16.3557 16.625 15.0415C16.625 13.7273 17.6858 12.6665 19 12.6665C20.3141 12.6665 21.375 13.7273 21.375 15.0415C21.375 16.3557 20.3141 17.4165 19 17.4165Z"
                fill="#A19D9D"
              />
            </svg>

            <p>My Profile</p></a
          >
          <a
            class="nav-item flex gap-6 items-center hover:text-white transition duration-300"
            href="{% url 'movie:logout' %}"
            ><svg
              width="24"
              height="24"
              viewBox="0 0 38 38"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M26.9167 12.6667L24.6842 14.8992L27.1858 17.4167H14.25V20.5833H27.1858L24.6842 23.085L26.9167 25.3333L33.25 19L26.9167 12.6667ZM7.91667 7.91667H19V4.75H7.91667C6.175 4.75 4.75 6.175 4.75 7.91667V30.0833C4.75 31.825 6.175 33.25 7.91667 33.25H19V30.0833H7.91667V7.91667Z"
                fill="#A19D9D"
              />
            </svg>

            <p>Logout</p></a
          >
        </div>
        {% endif %}
      </div>

      <div
        class="flex-grow md:pt-7 pt-0 pb-7 border-x md:px-[2vw] px-[4vw] border-gray-darken min-h-screen"
      >
        <div class="flex justify-end my-4">
          <div>
            {% if movie_user %}
            <div class="flex items-center justify-center gap-4">
              <div class="text-center">
                <p class="text-lg text-white">{{ movie_user.name }}</p>
                {% if movie_user.name == "root" %}
                <p>Admin</p>
                {% else %}
                <p>User</p>
                {% endif %}
              </div>

              <div
                id="name"
                class="w-[48px] h-[48px] rounded-[24px] bg-[#48C4EBB8] text-white leading-[48px] text-center text-[24px] select-none"
              ></div>
            </div>
            {% else %}
            <a href="{% url 'movie:register' %}">Signup</a>
            <a href="{% url 'movie:login' %}" class="ml-4">Login</a>
            {%endif%}
          </div>
        </div>
        <div>{% block content %} {% endblock %}</div>
      </div>
    </div>
    <script>
      $(function () {
        var pathname = location.pathname;
        var navs = $(".nav-item");
        navs.removeClass("active");
        navs.each(function () {
          var href = $(this).attr("href").includes("?")
            ? $(this).attr("href").split("?")[0]
            : $(this).attr("href");
          if (href == pathname) {
            $(this).addClass("active");
          }
        });
        if (/movie\/detail/.test(pathname)) {
          $(".left-menu").addClass("menu-collapse");
        }

        var name = "";
        {% if movie_user %}
          name = "{{ movie_user.name }}";
        {% endif %}
        $("#name").text(name.substring(0,1))


        var movie_qs_len = 0;
        {% if movie_qs_len %}
          movie_qs_len = {{movie_qs_len}};
        {% endif %}

        $("#recommend-nav").on('click', function(){
          if(movie_qs_len <= 10){
            layer.msg("You need to rate > 10 movies <br /> to use this feature", {
              skin: 'custom-msg',
            });
            return false;
          } else {
            location.href = $(this).attr("href");
          }
        })
      });
    </script>
  </body>
</html>
